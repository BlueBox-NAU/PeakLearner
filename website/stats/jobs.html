{% extends "../templates/base.jinja2" %}

{% block inner_head %}
    <title>Job Stats</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
{% endblock %}

{% block content %}
<div class="container-fluid d-flex flex-column flex-grow h-100">
    <h1>PeakLearner Job Stats</h1>
    <div class="row">
        <div class="col">
            <p>Total number of jobs: {{numJobs}}</p>
            <p>Total number of new jobs: {{newJobs}}</p>
            <p>Total number of queued jobs: {{queuedJobs}}</p>
            <p>Total number of processing jobs: {{processingJobs}}</p>
            <p>Total number of done jobs: {{doneJobs}}</p>
            <p>Average time per job: {{avgTime}}</p>
        </div>
    </div>

    <h2>Individual Job Stats</h2>
    <div class="row">
        {% for job in jobs %}
        <div class="col-sm-3">
            {# the |string converts job['id'] to a string from an int#}
            <h3>Job: <a href="{{job['id']|string + '/'}}">{{job['id']}}</a></h3>
            <p>Hub Link: <a href="/{{job['user']}}/{{job['hub']}}/">{{job['user'] + '/' + job['hub']}}</a></p>
            <p>Job Type: {{job['type']}}</p>
            <p>Job Status: {{job['status']}}</p>
            {% if job['status'] == 'Done' %}
            <p>Total Time: {{job['time']}}</p>
            {% endif %}
            {# TODO: Maybe add a way to change status of a job from this page #}
        </div>
        {% endfor %}

    </div>
</div>
{% endblock %}